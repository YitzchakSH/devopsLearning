<style>*{direction: rtl}</style>

# ארכיטקטורה

- ה-AWS מורכב מ-region שונים ברחבי העולם, וכל אחד מורכב ממספר availability zone שונים. כל availability zone הוא data center (אחד לפחות) נפרד.
- התקשורת של ה-AWS מתבצעת ע"י חיבור ל-AWS Global Network – חיבור מהיר חזק ושריד שמאפשר העברת מידע בצורה טובה.
- מהירות התקשורת הכי גבוהה בתוך אותו availability zone, ובכי איטית בין region-ים שונים. ככלל – מפרידים region רק בשביל שרידות גבוהה.
- אפשרויות נוספות של מיקומי שירותים שיחוברו ל-region:
  - AWS Outpost – שרתי on-pemise שחוברו ל-AWS
  -	AWS Local Zone – שרתים שקרובים אלי, אבל יקרים יותר, נועד לשיפור מהירות.
  -	AWS Wavelength Zone – שירותים עבור טלפונים – עם מהירות גבוהה לגישת ניידים.
- Cloudfront – שירות המאפשר לקרב את המידע למשתמשים ברחבי העולם, המידע נשמר כ-cache בשרתים הקרובים למשתמשים.
- כל חשבון AWS מזוהה ע"י Account ID, ויכול להכיל alias שיהיה unique בעולם.

# Billing and Cost Management

- כברירת מחדל רק למשתמש root יש הרשאה להתעסק בתשלומים, צריך לפתוח את האפשרות אם רוצים לאפשר למשתמש IAM.
- כברירת מחדל, לא יתקבלו התרעות על חריגות ופירוט מחוץ ל-AWS. כדי לאפשר שליחת מיילים יש להפעיל את האופציות תחת Billing and Cost Management/Billing Preferences. לאחר מכן יש להגדיר תקציב, תחת Billing and Cost Management/Budgets.
- פירוט התשלומים שבוצעו נמצא ב-Billing and Cost Management/Cost Explorer.
- סוגי תשלומים:
  - Compute – תשלום לפי משאבי CPU+RAM שנצרכו. מפסיקים לשלם כאשר השירות כבוי.
  - Storage – תשלום לפי מקום משומש (לדוג' ב-S3) או מקום מוקצה (לדוג' ESB)
  - Outbound Data Transfer – תשלום עבור הוצאת נתונים מה-region (אף פעם לא על הכנסה)
- צורות תשלום:
  -	Pay as you go – הכי גמיש, אבל משלמים מחיר מלא.
  - Save when you reserve – תשלום מראש אבל עם סכומים מופחתים.
  - Pay less by using more – בהתחלה תשלום רגיל, אבל אח"כ תשלום יותר נמוך על שטח אכסון גדול יותר

# IAM - Identity and Access Management

- משתמש IAM הוא משתמש מערכת רשום, להבדיל ממשתמש ROOT שהוא המשתמש שהקים את המערכת, יש לו הרשאות בלתי מוגבלות, ולא מומלץ להשתמש בו.
- מטרת ה-IAM - לנהל משתמשים שונים לכל אחד, והרשאות הגישה
  המתאימות לכל אחד.
  - קביעת מדיניות סיסמאות עבור הארגון.
  - Identity information assurance - תיעוד בקשות של המשתמשים
    מה-AWS
  - Eventually consistent - המידע משוכפל על פני השרתים בכל
    העולם
- מונחים:
  - Principle - משתמש או תוכנה המזדהים כחשבון או role
  - Authentication - הזדהות לחשבון
  - Request - בקשה לביצוע פעולה, מכיל את הפעולה והמשאב עליו מבצעים את
    הפעולה
  - Authorization - הרשאה שחשבון מכיל. ההרשאות מסודרות
    ב-JSON. משתמש ללא הגדרה נחשב משתמש ללא כל
    הרשאה
  - Action/operation - הפעולה שתתבצע על המשאב, לאחר אימות
    ההרשאה
  - Resources - משאב זה אחד האובייקטים הקיימים בשירות
    ה-AWS
- IAM מכיל משתמשים, קבוצות והרשאות
- משתמשים:
  - משתמשים יכולים להזדהות לפי שמם, ה-ARN
    (amazon resource name, מזהה ייחודי בכל
    רחבי AWS) או ID (עבור
    ה-CLI/API)
  - משתמשים יכולים מאמתים זהות לפי סיסמה, access
    key, SSH או תעודה
  - עד 5000 משתמשים
  - המשתמשים מקבלים את ההרשאות לפי הקבוצות שהם בהם או
    ישירות
  - על כל או קבוצה ניתן לראות את ה- Identity information
    assurance עד 400 ימים
  - בדף הגישה להרשאות ניתן לראות איזה policy העניקה את
    ההרשאה למשאב המסוים, ולאתר את הקבוצה דרכה ניתן ה-policy
    ב-permission
  - קיימת אפשרות להגדיר MFA (multi factor authentication)
- קבוצות
  - קבוצות לא יכולות להכיל קבוצות אחרות, אך משתמשים יכולים להכיל מספר קבוצות
- Policy - אוסף הרשאות הניתנות לשיוך לקבוצה או למשתמש
  - Policy לרוב בנוי מ-JSON, ומכיל 4 הגדרות: השירות
    המבוקש, הפעולות על השירות, המשאבים שיש לשירות, הגבלות ותנאים (כגון
    הגבלת זמן הפוליסה).
  - ניתן לראות משם מי מהמשתמשים ניגש לכל הרשאה.
  - סוגי הרשאה:
    - Inedtity-based - הרשאות הניתנות לקבוצה/משתמש
    - Resource-based (inline policy) - הרשאה המיוחדת למשתמש אחד בלבד,
      ומהווה חלק מהמשתמש
    - Permission Boundaries
    - Organization SCPs
    - Access Control List (ACL)
    - Session
- Role - מקבץ הרשאות הניתנות לשיוך באופן זמני
  - ההרשאות "מחליפות" את ה-policy המשוייכים למשתמש
  - ה-role יכול להיקבע עבור אחד מהבאים: משתמש, משתמש
    מחשבון אחר, שירות (כגון EC2), ישות שבצעה
    הזדהות
  - ה-role מקבל policy, ישות שנגשה ל-role מקבלת את ה-policy האלה באופן זמני.
  - על מנת להתחבר ל-role המשתמש צריך הרשאה מסוג "sts:AssumeRole" ועם resource של ה-role.
  - ה-role פעיל לפרק זמן שהוגדר, בין שעה ל-12 שעות
- IAM identity center
  - מאפשר ניהול מרכזי עבור משתמשי קצה.
  - מקבל משתמשים מסוגים רבים של identity manamegent, כדוגמת AD, AZURE ועוד.
  - מקצה role-ים שהוגדרו ב-AWS IAM עבור המשתמשים.
  - לא מספק policy, access key, B2B. מיועד לניהול משתמשים אנושיים.

# EC2
- שרידות מערכות - מושגים שונים:
  - High Availability - שירות שזמין כמעט כל הזמן ללא נפילות, אבל עדיין יכול להשתמש בשירות א-סינכרוני. ניתן להשגה ע"י ידי יתירות, ELB, auto scaling, route 53
  - Falt tolerance - שירות ללא כל נפילות.
    לכן ישתמש בהרבה שרידות יקרה ובשירותים סינכרונים בלבד. 
    ניתן להשיג ע"י disk mirroring (RAID), Fault tolerance NICs, synchronous DB replication.
  - durability - שרידות המידע במערכת.
    נדיר שמתרחשות פה בעיות.
  - Availability - זמינות המידע. האפשרות לגשת למידע.
  - Scale up - הוספת משאבים נוספים לשירות הקיים.
    משמש ב-statefull servise - שירות שמקבל שינויים
  - Scale out - הקמת נותני שירות נוספים (שרתים נוספים).
    משמש ב-srateless service - שירות שלא משתנה.
    יש להפריד בין השירותים statefull ו-stateless

- EC2 - elastic compute cloude - שרת כללי.
  - סוג שרת:
    - מוגדר במשאבים: CPU, Memory, Storage, Networking.
    - השרתים מחולקים למשפחות לפי חלוקת המשאבים שלהם
    - כל סוג שרת מורכב מהפרמטרים הבאים:
      - אות(/יות) ראשונה - שם המשפחה של השרת
      - מספר - דור השרת
      - .
      - מילה - גודל השרת

  - AMI - Amazon Machine Images - זה image עבור שרתי EC2, עם מערכות הפעלה משתנות
    - רשמי - AMI שמופץ ע"י אמזון
    - community - AMI שיוצר בקהילה ונפתח לשימוש
    - פרטי - AMI שיוצר באופן פרטי, מכיל מערכת הפעלה עם כלל ההגדרות והקבצים שיצר המשתמש

  - EC2 storage:
    - Instance Store - אכסון מהיר ונדיף (כל המידע שבו נמחק ברגע שה-EC2 נכבה). לא ניתן להעביר ל-EC2 אחר.
    - EBS - elastic block store - אכסון המוצמד למכונה אחת, אך לא נמחק כשהיא נכבית, וניתן להעבירו ל-EC2 אחר.
      - ה-EBS מחולק לסוגים, מהם יש שמסוגלים להתחבר לשני שרתים, אבל הם לא מיועדים לאכסון כללי, אלא לסגנון cluster.
      - ה-EBS הוא אכסון מרוחק, אבל הוא חייב לשבת באותו availability zone כמו ה-EC2

  - interface:
    - private IP address - כתובת IP פנימית וחד פעמית, כלומר אי אפשר להעבירה ידנית לשרת אחר.
    - Elastic IP address - כתובת IP פנימית שנוצרה מראש ושויכה זמנית עבור EC2 מסוים.
    - public IP address - כתובת IP חיצוני עבור ה-EC2, נוצרת רק כאשר נמצאים ב-public subnet. הכתובת לא מוכרת לשרת ומשויכת ע"י ה-AWS.
    - ENI - Elastic Network Interfase - זה NIC פשוט.
    - ENA - Elastic Network Adapter - זה NIC רחב ומהיר, אבל לא נתמך בכל instance.
    - EFA - Elastic Fabric Adapter - זה NIC סופר רחב ומהיר, נתמך בכל ה-iinstace-ים, ומיועד בעיקר לעבודה מקבילית (MPI).
     תומך ב-RDMA - גישה לזכרון של inctance מרוחק ללא שימוש ב-CPU.

  - Security group - ה-FW של השירותים
    - עובד בשיטת whitelist.
    - אובייקט עצמאי שניתן לחבר למספר רב של שירותים.
    - כל EC2 יכול להכיל עד 5 security group.

  - key-pair - מפתח הגישה לשרת
    - ב-linux משמש להתחברות לשרת
    - ב-windows משמש ע"מ לייצא את הסיסמא עבור ה-RDP

  - גישה מ-EC2 לשירותי AWS
    - Access key - הנפקת מפתח גישה והזנה לתוך השרת. מקבל את אותם ההרשאות כמו המשתמש שהנפיק. לא מאובטח, מכיוון שנשמר על המחשב ויכול להיגנב.
    - IAM Role - יצירת Role והקצאתו ל-EC2. זוהי האפשרות המאובטחת , היא משתמשת ב-STS (Security Token Service), שמקצה ומתחזק access key מאחורי הקלעים.

  - template סט הגדרות שלם עבור יצירת שרת.
    - ה-template מכיל את כלל ההנחיות כיצד ליצור את ה-EC2, החל מ-type, AMI, Security group וכלה ב-userData - סקריפט לקינפוג תוכן המערכת.

    - ASG - Auto Scaling Group - הגדרת חוות שרתים (או שירותים במקרה של EKS, ECS).
      - מקבל tempalte , VPC, Availability zones.
      - כמות השרתים נקבעת ע"י:
        - ידנית (הגדרת מספר קבוע).
        - דינמי - לפי ניטור של cloudwatch (ניטור מצב שרתים).
        - predictive - לפי הבנת דפוסים של ה-AWS כהכנה לעומסים.
        - scheduled - מתוזמן מראש, ע"מ להתכונן לעומסים.
      - יודע לבצע scale out ו-scale in.
        - ניתן להגדיר לשרתים מסוימים scale in protection, כך שהם לא ימחקו במהלך scale in.
      - יכול להתחבר ל-ELB ועוד.
      - ניתן להגדיר health check אפליקטיבי.
      - אפשר להוציא שרת מה-auto scaling group, להפוך אותו למופע בודד.
      - מבזר ב-availability zone בצורה שווה.

  - ELB - LB שיכול לשמש עבור
    EC2.
- EFS - elastic file system - עבור לינוקס, מהווה
  מעין NAS, ניתן להתחבר אליו מכמה שרתים במקביל.
- S3 - אכסון לטווח ארוך
- cloudFront - CACHE עבור S3
- AURORA - עוטף את ה-RDS כדי לבצע אוטומציות של
  הקמות DB
- RDS - DB רלציוני
- RDS Proxy - פרוקסי ל-RDS
- Elasticcache - CACHE עבור RDS
- dinamoDB - DB לא רלציוני
- DAX - cache עבור dinamoDB
- VPC - virtual private cloud - סביבות שונות על מנת
  להגביר אבטחה, ומכיל מתחתיו שירותים ואינטרנט מנותק (כמו להיות
  מאחורי FW עם VPN).

3 tier web application

