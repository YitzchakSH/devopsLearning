<style>*{direction: rtl}</style>

# ארכיטקטורה

- ה-AWS מורכב מ-region שונים ברחבי העולם, וכל אחד מורכב ממספר availability zone שונים. כל availability zone הוא data center (אחד לפחות) נפרד.
- התקשורת של ה-AWS מתבצעת ע"י חיבור ל-AWS Global Network, הכוללת את הקישורים הפנימיים ואת ה-AWS Backbone – חיבור מהיר חזק ושריד שמאפשר העברת מידע בצורה טובה.
- מהירות התקשורת הכי גבוהה בתוך אותו availability zone, ובכי איטית בין region-ים שונים. ככלל – מפרידים region רק בשביל שרידות גבוהה.
- אפשרויות נוספות של מיקומי שירותים שיחוברו ל-region:
  - AWS Outpost – שרתי on-pemise שחוברו ל-AWS
  -	AWS Local Zone – שרתים שקרובים אלי, אבל יקרים יותר, נועד לשיפור מהירות.
  -	AWS Wavelength Zone – שירותים עבור טלפונים – עם מהירות גבוהה לגישת ניידים.
- Cloudfront – שירות המאפשר לקרב את המידע למשתמשים ברחבי העולם, המידע נשמר כ-cache בשרתים הקרובים למשתמשים.
- כל חשבון AWS מזוהה ע"י Account ID, ויכול להכיל alias שיהיה unique בעולם.

# Billing and Cost Management

- כברירת מחדל רק למשתמש root יש הרשאה להתעסק בתשלומים, צריך לפתוח את האפשרות אם רוצים לאפשר למשתמש IAM.
- כברירת מחדל, לא יתקבלו התרעות על חריגות ופירוט מחוץ ל-AWS. כדי לאפשר שליחת מיילים יש להפעיל את האופציות תחת Billing and Cost Management/Billing Preferences. לאחר מכן יש להגדיר תקציב, תחת Billing and Cost Management/Budgets.
- פירוט התשלומים שבוצעו נמצא ב-Billing and Cost Management/Cost Explorer.
- סוגי תשלומים:
  - Compute – תשלום לפי משאבי CPU+RAM שנצרכו. מפסיקים לשלם כאשר השירות כבוי.
  - Storage – תשלום לפי מקום משומש (לדוג' ב-S3) או מקום מוקצה (לדוג' ESB)
  - Outbound Data Transfer – תשלום עבור הוצאת נתונים מה-region (אף פעם לא על הכנסה)
- צורות תשלום:
  -	Pay as you go – הכי גמיש, אבל משלמים מחיר מלא.
  - Save when you reserve – תשלום מראש אבל עם סכומים מופחתים.
  - Pay less by using more – בהתחלה תשלום רגיל, אבל אח"כ תשלום יותר נמוך על שטח אכסון גדול יותר

# IAM - Identity and Access Management

- משתמש IAM הוא משתמש מערכת רשום, להבדיל ממשתמש ROOT שהוא המשתמש שהקים את המערכת, יש לו הרשאות בלתי מוגבלות, ולא מומלץ להשתמש בו.
- מטרת ה-IAM - לנהל משתמשים שונים לכל אחד, והרשאות הגישה
  המתאימות לכל אחד.
  - קביעת מדיניות סיסמאות עבור הארגון.
  - Identity information assurance - תיעוד בקשות של המשתמשים
    מה-AWS
  - Eventually consistent - המידע משוכפל על פני השרתים בכל
    העולם
- IAM מכיל משתמשים, קבוצות והרשאות

### מונחים:

- Principle - משתמש או תוכנה המזדהים כחשבון או role
- Authentication - הזדהות לחשבון
- Request - בקשה לביצוע פעולה, מכיל את הפעולה והמשאב עליו מבצעים את
  הפעולה
- Authorization - הרשאה שחשבון מכיל. ההרשאות מסודרות
  ב-JSON. משתמש ללא הגדרה נחשב משתמש ללא כל
  הרשאה
- Action/operation - הפעולה שתתבצע על המשאב, לאחר אימות
  ההרשאה
- Resources - משאב זה אחד האובייקטים הקיימים בשירות
  ה-AWS

### משתמשים:

- משתמשים יכולים להזדהות לפי שמם, ה-ARN
  (amazon resource name, מזהה ייחודי בכל
  רחבי AWS) או ID (עבור
  ה-CLI/API)
- משתמשים יכולים מאמתים זהות לפי סיסמה, access
  key, SSH או תעודה
- עד 5000 משתמשים
- המשתמשים מקבלים את ההרשאות לפי הקבוצות שהם בהם או
  ישירות
- על כל או קבוצה ניתן לראות את ה- Identity information
  assurance עד 400 ימים
- בדף הגישה להרשאות ניתן לראות איזה policy העניקה את
  ההרשאה למשאב המסוים, ולאתר את הקבוצה דרכה ניתן ה-policy
  ב-permission
- קיימת אפשרות להגדיר MFA (multi factor authentication)

### קבוצות

- קבוצות לא יכולות להכיל קבוצות אחרות, אך משתמשים יכולים להכיל מספר קבוצות

### Policy - אוסף הרשאות הניתנות לשיוך לקבוצה או למשתמש

- Policy לרוב בנוי מ-JSON, ומכיל 4 הגדרות: השירות
  המבוקש, הפעולות על השירות, המשאבים שיש לשירות, הגבלות ותנאים (כגון
  הגבלת זמן הפוליסה).
- ניתן לראות משם מי מהמשתמשים ניגש לכל הרשאה.
- סוגי הרשאה:
  - Inedtity-based - הרשאות הניתנות לקבוצה/משתמש
  - Resource-based (inline policy) - הרשאה המיוחדת למשתמש אחד בלבד,
    ומהווה חלק מהמשתמש
  - Permission Boundaries
  - Organization SCPs
  - Access Control List (ACL)
  - Session

### Role - מקבץ הרשאות הניתנות לשיוך באופן זמני

- ההרשאות "מחליפות" את ה-policy המשוייכים למשתמש
- ה-role יכול להיקבע עבור אחד מהבאים: משתמש, משתמש
  מחשבון אחר, שירות (כגון EC2), ישות שבצעה
  הזדהות
- ה-role מקבל policy, ישות שנגשה ל-role מקבלת את ה-policy האלה באופן זמני.
- על מנת להתחבר ל-role המשתמש צריך הרשאה מסוג "sts:AssumeRole" ועם resource של ה-role.
- ה-role פעיל לפרק זמן שהוגדר, בין שעה ל-12 שעות

### Insstance Profile

- אוסף של role.
- ניתן לשיוך ל-EC2 בלבד.

### IAM identity center

- מאפשר ניהול מרכזי עבור משתמשי קצה.
- מקבל משתמשים מסוגים רבים של identity manamegent, כדוגמת AD, AZURE ועוד.
- מקצה role-ים שהוגדרו ב-AWS IAM עבור המשתמשים.
- לא מספק policy, access key, B2B. מיועד לניהול משתמשים אנושיים.

# EC2 - שירותי מחשוב

### שרידות מערכות - מושגים שונים:

- High Availability - שירות שזמין כמעט כל הזמן ללא נפילות, אבל עדיין יכול להשתמש בשירות א-סינכרוני. ניתן להשגה ע"י ידי יתירות, ELB, auto scaling, route 53
- Falt tolerance - שירות ללא כל נפילות.
  לכן ישתמש בהרבה שרידות יקרה ובשירותים סינכרונים בלבד. 
  ניתן להשיג ע"י disk mirroring (RAID), Fault tolerance NICs, synchronous DB replication.
- durability - שרידות המידע במערכת.
  נדיר שמתרחשות פה בעיות.
- Availability - זמינות המידע. האפשרות לגשת למידע.
- Scale up - הוספת משאבים נוספים לשירות הקיים.
  משמש ב-statefull servise - שירות שמקבל שינויים
- Scale out - הקמת נותני שירות נוספים (שרתים נוספים).
  משמש ב-srateless service - שירות שלא משתנה.
  יש להפריד בין השירותים statefull ו-stateless
- scale in - מחיקת שירותים לא נצרכים, לאחר שבוצע scale out

## EC2 - elastic compute cloude

- שרת כללי
- כל שרת מוגדר במשאבים: CPU, Memory, Storage, Networking.
- השרתים מחולקים למשפחות לפי חלוקת המשאבים שלהם
- כל סוג שרת מורכב מהפרמטרים הבאים:
  - אות(/יות) ראשונה - שם המשפחה של השרת
  - מספר - דור השרת
  - .
  - מילה - גודל השרת

### AMI - Amazon Machine Images

- זהו image עבור שרתי EC2, עם מערכות הפעלה משתנות
- סוגי AMI:
  - רשמי - AMI שמופץ ע"י אמזון
  - community - AMI שיוצר בקהילה ונפתח לשימוש
  - פרטי - AMI שיוצר באופן פרטי, מכיל מערכת הפעלה עם כלל ההגדרות והקבצים שיצר המשתמש
- AMI זמינים לפי region. אם רוצים להשתמש ב-AMI הפרטי שנוצר ב-region מסוים יש להעתיק אותו ל-region האחר.

### EC2 storage:

- Instance Store - אכסון מהיר ונדיף (כל המידע שבו נמחק ברגע שה-EC2 נכבה). לא ניתן להעביר ל-EC2 אחר.
- EBS - elastic block store - אכסון המוצמד למכונה אחת, אך לא נמחק כשהיא נכבית, וניתן להעבירו ל-EC2 אחר.
  - ה-EBS מחולק לסוגים, מהם יש שמסוגלים להתחבר לשני שרתים, אבל הם לא מיועדים לאכסון כללי, אלא לסגנון cluster.
  - ה-EBS הוא אכסון מרוחק, אבל הוא חייב לשבת באותו availability zone כמו ה-EC2
- מידע נוסף - תחת נושא Storage

### interface:

- private IP address - כתובת IP פנימית וחד פעמית, כלומר אי אפשר להעבירה ידנית לשרת אחר.
- Elastic IP address - כתובת IP פנימית שנוצרה מראש ושויכה זמנית עבור EC2 מסוים.
- public IP address - כתובת IP חיצוני עבור ה-EC2, נוצרת רק כאשר נמצאים ב-public subnet. הכתובת לא מוכרת לשרת ומשויכת ע"י ה-AWS.
- ENI - Elastic Network Interfase - זה NIC פשוט.
- ENA - Elastic Network Adapter - זה NIC רחב ומהיר, אבל לא נתמך בכל instance.
- EFA - Elastic Fabric Adapter - זה NIC סופר רחב ומהיר, נתמך בכל ה-iinstace-ים, ומיועד בעיקר לעבודה מקבילית (MPI).
  תומך ב-RDMA - גישה לזכרון של inctance מרוחק ללא שימוש ב-CPU.

### Security group - ה-FW של השירותים

- כל EC2 יכול להכיל עד 5 security group.
- vrjcu, cxeahhi VPC - Networking

### key-pair - מפתח הגישה לשרת

- ב-linux משמש להתחברות לשרת
- ב-windows משמש ע"מ לייצא את הסיסמא עבור ה-RDP

### גישה מ-EC2 לשירותי AWS

- Access key - הנפקת מפתח גישה והזנה לתוך השרת. מקבל את אותם ההרשאות כמו המשתמש שהנפיק. לא מאובטח, מכיוון שנשמר על המחשב ויכול להיגנב.
- IAM Role - יצירת Role והקצאתו ל-EC2. זוהי האפשרות המאובטחת , היא משתמשת ב-STS (Security Token Service), שמקצה ומתחזק access key מאחורי הקלעים.

### template סט הגדרות שלם עבור יצירת שרת.

- ה-template מכיל את כלל ההנחיות כיצד ליצור את ה-EC2, החל מ-type, AMI, Security group וכלה ב-userData - סקריפט לקינפוג תוכן המערכת.

## load balancer

- לצורך מודליות הופרד יחידת ה-loadBalancer ל-2 חלקים: Targer Group ו-LB

### ASG - Auto Scaling Group - הגדרת חוות שרתים (או שירותים במקרה של EKS, ECS).
- מקבל tempalte , VPC, Availability zones.
- כמות השרתים נקבעת ע"י:
  - ידנית (הגדרת מספר קבוע).
  - דינמי - לפי ניטור של cloudwatch (ניטור מצב שרתים) ע"י יצירת alarm. בתגובה ל:
    - CPU
    - תקשורת רשת נכנסת
    - תקשורת רשת יוצאת
    - מספר בקשות ב-LB
  - predictive - לפי הבנת דפוסים של ה-AWS כהכנה לעומסים.
  - scheduled - מתוזמן מראש, ע"מ להתכונן לעומסים.
- יודע לבצע scale out ו-scale in.
  - ניתן להגדיר לשרתים מסוימים scale in protection, כך שהם לא ימחקו במהלך scale in.
- יכול להתחבר ל-LB ועוד.
- ניתן להגדיר health check אפליקטיבי.
- אפשר להוציא שרת מה-auto scaling group, להפוך אותו למופע בודד.
- מבזר ב-availability zone בצורה שווה.

### Target Group

- מכיל קבוצה לוגית של שירותי מחשוב, מתאים ל-LB מסוג מסוים, בהתאם לקינפוג.
- Target - המחשוב שמוכל הקבוצה. יכול להכיל: Lambda, EC2 instance או כתובות private IP.
  - Lambda רק עבור ALB.
- Protocol/Port to connect - הגדרת הצד הפנימי של ה-LB, איך ה-LB מגיע אל השרתים עצמם.
  - HTTP/HTTPS עבור ALB.
  - TCP/UDP עבור NLB.
- Health checks - בדיקה שהשירותים של ה-terget תקינים.
  - בדיקה מלאה עבור ALB.
  - בדיקה של handshake עבור TCP ב-NLB.
- Deregistration Delay - זמן המתנה בין תקשורת אחרונה לניתוק השרת (לצורך שדרוג או מחיקה).
- Stickiness - תקשורת תתבצע לאותו שירות שהחל לתת מענה בעבר.
  - קיים בצורה מלאה ע"י עוגיות עבור ALB בלבד.
  - קיים ברמת IP (מקור, יעד ופורט) עבור NLB.
- Slow Start - הגדלת אחוז התעבורה באופן הדגרתי, עבור שירותים שעומס פתאומי יכול לגרום להם לנפילות
  - קיים עבור ALB בלבד.

### NLB - Network Load Balancer

- LB קלאסי, מהיר, לפניות שאינם מבוססות HTTP
- עובד בשכבה 4, עובד עם פרוטוקולי TCP, TLS, UDP
- מקבל מסנן פניות לפי PORT קבלה.
- מכיל כתובת IP, סטטית או אלסטית (משתנה לפי AWS)
- מגן על נותני השירות ממחיקה.


### ALB - Application load balancer

- LB שמיועד עבור שירותי:
  - HTTP.
  - Lambda
  - microservice-ים - כדוגמת container
- עובד בשכבה 7, עובד עם פרוטוקולי HTTP, HTTPS, gRPC.
- מסנן פניות לפי:
  - שם DNS: שם השרת.
  - נתיב: הכתובת שלאחר שם השרת.
  - Header: מידע שמוכל בפקטה.
  - שאילתה שמופיעה בנתיב הבקשה.
  - IP מקור.
  - פעולה: מהי הפעולה שהביאה את הבקשה.
- תומך הזדהות OIDC, WAF, ניתוב HTTP ל-HTTPS ועוד.
- ניתוק תקשורות קיימות כברירת מחדל אחרי 60 שניות.
- שולח לוגים ל-S3.
- מגן על נותני השירות ממחיקה.

### GWLB - Gateway Load Balancer

- מיועד עבור שירותי אבטחה בכניסה לרשת, דוגמת FW, ע"מ למנוע מצב של קריסת רכיבי ההגנה.
- מתתרחש בשכבה השלישית (networking).
- שקוף תעבורתית.
- בצורה טיפוסית, פניית הלקוח תועבר כך:
  - הלקוח פונה ל-VPC של האפליקציה
  - ה-VPC מפנה את הבקשה ל-GWLB באמצעות route table
  - הבקשה עוברת את ה-FW
  - הבקשה מופנית חזרה ל-ALB/NLB.

### CLB - Classic Load Balancer

- שירות deprecated שכבר לא נתמך על ידי שירותים רבים

### דגשים

- במקרה של הוספת availability zone יש להוסיף גם ב-ASG וגם ב-LB.

# VPC - networking

## רכיבי תקשורת פנימיים

### VPC - Virtual Private Cloude

- ענן פרטי ומנותק המוכל ב-region ומגדיר את טווח הכתובות של כלל השירותים שבו.
- כלל שירותי ה-privater service יושבים בתוך ה-VPC, ו-private services יושבים מחוץ לו באינטרנט.
- אם יוצרים מספר VPC באותו region - מומלץ להפריד את טווח הכתובות שלהם (מכיוון שיש שירותים שמסתכלים על זה).

### subnet

- מקבל מה-VPC טווח כתובות ומספק אותם לשירותים היושבים תחתיו.
- כל subnet מוכל בתוך availability zone אחד בלבד.
- subnet עם גישה ישירה לאינטרנט מכונה public, בלי גישה ישירה מכונה private.

### Internet Gateway

- חיבור של ה-VPC אל האינטרנט.
- ללא internet gateway לא יהיה ל-VPC אף חיבור לאינטרנט.

### router

- מנתב את כלל התקשורת בתוך ה-VPCת באמצעות ה-route table.
- ניתן ליצור יותר מאחד בכל VPC
- כל subnet משוייך ל-router אחד.
- טבלת ניתוב בסיסית:
  - 10.0.0.0/16 - Local - טבלת ניתוב פנימית.
  - 0.0.0.0/0 - igw-id - חיבור לאינטרנט (במקרה של VPC עם חיבור).

### Network ACL

- FW ברמת ה-subnet
- ה-network ACL מנטר אך ורק תקשורת הנכנסת או היוצאת מתוך ה-subnet.
- פועל בתצורת stateless, כלומר הוא לא יודע אם התקשורת היוצאת היא תגובה לתקשורת שנכנסה, או תקשורת חדשה.
- מכיל הגדרות allow ו-deny
- מכיל את ההגדרות לפי הסדר.
- מכיל רק כתובות IP או subnet

### Security Group

- FW ברמת השירותים
- פועל בתצורת statefull, כלומר יודע אם תקשורת יוצאת מקורה בתקשורת שנכנסה.
- עובד בשיטת whitelist.
- ה-security group מוגבל ל-VPC אחד, אבל יכול להיות במספר availability zones.
- יכול להכיל לפי IP או לפי אובייקטים בסגנון security group אחר.

###  route 53

- שירות ה-DNS של AWS עם פי'צרים.
- מספק אפשרויות לרישום דומיין, וניהול רשומות DNS
- מאפשר לנתב  פניות ל-regions שונים בהתאם למיקום או לכתובת ה-IP
- מאפשר לבצע health check ל-region ולהפנות לאחר במידת הצורך.
- מאפשר לבצע load balancing בין regions שונים, עם משקל.

## חיבור לרשת פרטית

- ע"מ לחבר לרשת פרטית ישנם שתי אפשרויות, וניתן לשלב את שתיהן:
  - VPN - חיבור לוגי המאבטח את התקשורת, מוכרב מ-VGW, CGW ו-VPN connection
  - Direct Connect - חיבור פיזי ל-AWS Backbone
### VGW - Virtual private GateWay

- GW שמאפשר יציאה מה-AWS אל רשת פרטית אחרת
- נדרש לבגדיר עבורו גם route מתאים.
- יכול להתחבר להרבה CGW.

### CGW - Customer GateWay

- רכיב המייצג את נקודת הכניסה אל הרשת הפרטית.
- מכיל את ההגדרות התואמות לרכיבי התקשורת של הכניסה לרשת הפרטית
- יכול להתקשר למספר VGW

### VPN connection

- חיבור בין VGW ל-CGW.

### Direct Connect

- חיבור פיזי של התקשורת שלך ל-AWS Backbone.
- מספק תקשורת בטוחה, מהירה ויציבה יותר לענן.
- ניתן להתחבר ישירות או ע"י מארחים שמספקים חלק מרוחב הפס שלהם.
- על מנת להתחבר ל-VPC שלך צריך את הרכיבים הלוגים הבאים:
  - Direct Connect Connection -  מייצג את החיבור הפיזי בין הלקוח ל-AWS.
  - Virtual Interface (VIF) – מציין איך אתה משתמש בחיבור (private, public או transit)
  - Direct Connect Gateway (DXGW) - רשות - מאפשר ניהול מרכזי לניתוב חיבורים ל-VPCs שונים.

## perfomence improve

### CloudFront

- מהווה cache עבור פניות מרוחקות
- פרוס ברחבי העולם
- עובד בפרוטוקולי HTTP/HTTPS
- גם במקרה שאין cache - מקצר הגעה ל-region, מכיוון שמהווה שער גישה ל-AWS backbone.
- יכול לשמש כ-cache עבור מגוון רחב של שירותים, כדוג' S3, EC2, LB, Lambda.
- יכול להכיל תעודה עבור האתר ולנהל ממש מוצפן.
- יכול להפעיל בעצמו פונקציות lambda.
- תומך ב-VOD (video on demand)
- לא תומך בניתוב חכם בין regions

### Global Accelerator

- מספק ניתוב מהיר לכל פניות TCP/UDP ברחבי העולם.
- מספק 2 כתובות IP עבור road53, שלמעשה מפנים אותך לאתר הקרוב ביותר של AWS לפונה.
- מהאתר AWS הקרוב - השירות מנתב את הפניות ל-region הקרוב ביותר 
- ניתן לשלב עם cloudefront


# Storage

- ישנם שלושה סוגי אכסון:
  - block storage - Instance Store, EBS. דיסק מפורמט כמו שיש למחשבים.
  - file storage - EFS. שיתוף NAS שעדיין מתנהל כמו מערכת קבצים.
  - object storage - S3 bucket. אכסון קבצים זול שמתקשר באמצעות rest api.

### Instance Store

- אכסון מהיר מאוד, אבל נדיף.
- יושב בתוך אותם Data Center-ים של המכונות עצמם.
- משמש לזיכרון זמני או לזיכרון הניתן לשחזור.

### EBS - Elastic Block Storage

- ניתן לבחור את סוג הזיכרון, SSD, HDD, גודל ומשתנים נוספים.
- חייב לשבת באותו Availability zone כמו של המכונה.
- בפועל מתחבר דרך הרשת למכונה, אבל זה שקוף עבור המכונה.

### Snapshot 

- Snapshot הוא גיבוי של ה-EBS.
- incremental, כלומר במידה וכבר התבצע גיבוי, ה-snapshot מעתיק רק את השינויים הנוכחיים.
- מאוכסן ב-S3
- ניתן ליצור ממנו EBS חדש, או ליצור ממנו AMI (עיין תחת EC2)

### EFS - Elastic File Storage

- אכסון קבצים המשותף למספר מכונות.
- זמין ללינוקס בלבד
- מוקם ב-region
- ה-EFS הסטנדרטי מרופלק ל-3 zone-ים שונים, אבל אניתן לבחור one zone שיוזיל עלויות אבל יוריד שרידות.
- על מנת להתחבר ל-EFS, יוצרים בכל Availability zone קישור בשם mount target.
- החיבור מתבצע באמצעות פרוטוקול NFS 
- ניתן לרפלק את ה-EFS בין regions, אבל המשוכפל יהיה זמין רק לקריאה כל עוד הרפליקציה פעילה.
- סוגי אכסון:
  - סטנדרטי, לגישה יומיומית
  - IA - Infrwquent Access - זול ליגשה לא תדירה.
  - Archive - לגישה נדירה מאוד, בעיקר לגיבוי.
- תומך בפיצ'רים כגון נסעילת קובץ בשימוש, גיבויים, קביעת ביצועים

### S3 bucket

- אכסון מסוג object
- גישה באמצעות Rest API
- יושב מחוץ ל-region, לכן נדרשת גישה ל-IGW או ל-S3 Gatway Endpoint - שמייצר שער גישה רק ל-S3.
- לא מוגבל בגודל, pay as you go.
- אין לו מערכת קבצים, אמזון יוצר דמוי תיקייה כדי שיהיה נח לשימוש.
- סוג האכסון יכול להשתנות בהתאם לצרכים (לדוג' IA)
- S3 static website - פיצ'ר שמאפשר להציג אתר לתצוגה דרך ה-s3, מתוך מרכיבים שנמצאים בתוך האתר

# Databases

- ניתן ליצור DB ע"ג EC2, אבל AWS מאפשר ליצור DB מותאמים מראש עם מספר פיצ'רים:

### RDS

- DB רלציוני
- יושב על סוג שרת של EC2 ממשפחה המותאמת ל-DB.
- תומך במגוון סוגי DB מוכרים.
- יכול לבצע scale up אבל צריך לעבור restart.
- ע"מ להוריד עומסים ניתן לבצע רפליקציה אסינכרונית לשרת נוסף, שישמש לקריאה בלבד.
- RDS standby - גיבוי ל-RDS ב-AZ אחר, במקרה הצורך הוא יהפוך ל-primary.

### AURORA

- DB רלציוני מבוסס על RDB.
- אין צורך לדאוג לתשתיות השרתים, התשתיות מנוהלות ע"י AWS
- תומך בביצועים גבוהים במיוחד, ויכולת סקלאביליות אוטומטית במקרה הצורך.
- תומך multi-AZ על יכולת שחזור תוך מספר שניות במקרה של תקלות.
- תומך ב-MySQL וב-PostgreSQL בלבד.

### RDS Proxy

- שירות אופציונאלי אליו מתחברים לקוחות RDS או AURORA.
- ה-RDS Proxy מרכז אליו את כלל החיבורים, ומשקף ל-DC רק חיבור אחד, מה שמועיל מאוד עם העומסים על ה-DB ומגביר מהירות.
- ה-RDS Proxy מתחבר ל-DB ע"י IAM role, מה שמסייע בהגה על הפעולות המאושרות מול ה-DB.

### ElastiCache 

- שירות cache עבור כלל השירותים (לא רל DB-ים)
- הלקוח במצע פנייה ישירות ל-elasticache
- אם ה-elasticache מכיר את התשובה - הוא עונה. אם לא - הוא שואל את השירות שמאחוריו, ושומר לעצמו העתק של התשובה.
- קיים TTL למידע.
- כאשר מעדכנים את המידע - האפליקציה יכולה לעדכן את ה-elasticache ולמחוק מיד את הרשומה הקיימת.
- ניתן להחליט בקוד אילו נתונים יהיו שמורים ואילו לא.
- השירות רץ על Redis או Memcached.

### DinamicDB

- DB א-רלציוני.
- ללא שרת מאחוריו.
- מאפשר אכסון לפי key-value או מסמכים.
- מהירות קריאה נמוכה.
- קל ל-scaling
- מרופלק אוטומטית
- עוקב אחרי הפעולות, כך שניתן לקרוא אילו פעולות בוצעו או לשחזר לשנייה מסויימת.
- Strongly consistant או eventually consistant, תומך ACID.
- כל ה-partitions ניתנים לכתיבה וקריאה.

### DAX - DynamoDB Accelerator

- שירות cache מיוחד עבור DinamicDB
- שקוף כמעט לחלוטים לאפליקציה
- יש צורך להגדיר את ה-instance type שעליו יושב השירות, ולהגדיר auto scaling.
- עדכון נתוני ה-dynamoDB מתבצע דרך ה-DAX

# DevOps on AWS

### CloudFrormation

- כלי מובנה ליצירת ותחזוק שירותים 
- בנוי בפורמט JSON או YAML
- מקבץ הוראות המנוהל ב-region אחד ובחשבון AWS אחד מכונה stack.
- מקבץ הוראות המנוהל במספר regions או חשבונות AWS נקרא stackset.
- AWS יודע לנהל גרסאות stack, ולהציג מה השתנה בכל פעם.
- ניתן להגדיר שירותים שלא יימחקו עם ה-stack.
- מבנה ה-template:
  - כל מקטע מחולק לסוג המקטע, שמות משאבים עבור ה-stack, הגדרת המשאבים עצמם
  - סוגי מקטעים:
    - parameter - מאפשר להגדיר משתנים שניתן לערוך בעת יצירת ה-stack
    - Resources - השירותים עצמם
    - Output - פלט שיוצג כאשר ה-resource בעל השם התואם יסיים פריסה.

### Elastic Beanstalk

- פריסת קוד על שרת EC2 בצורת PaaS
- השירות מקבל את הקוד בצורת קובץ ZIP ופורס אותו על EC2
- כל קוד פריסה מכונה Application.
- כל פריסת קוד מכונה environment
- ישנם שני סוגי שרתים:
  - Web Servers - שרתים המיועדים להריץ אתר אינטרנט פשוט.
  - workers - שרתים המיועדים להריץ שירות שמבצע חישובים בתוך השרת
- הקוד שהועלה נשמר ב-S3 עם הגרסאות השונות שהועלו.
- ה-application זקוק ל-role כדי לתפקד, חובה גם להצמיד ל-EC2 key-pair ו-incstance profile

## code management

- AWS מכיל תשתית קוד מלאה, שנועדה להחליף את הצורך בכלים חיצוניים.

### CodeCommit

- הגיט של AWS.
- ניתן להתחבר על token ייעודי - HTTP Git credential for AWS CodeCommit.
- בתהליך גריטה, לא קיים עבור לקוחות חדשים

### CodeArtifact

- ה-Artifactory של AWS, לניהול חבילות Dependency.
- ה-CodeArtifact מחולק ל-domains - סביבות נפרדות לוגיות
- כל domain מכיל repository, שמכיל את החבילות בפועל
- ניתן לחבר את ה-repository ל-Upstream repositories שייבא את החבילה ממקור חיצוני.

### CodeBuild

- ה-CI של AWS
- ה-CodeBuild יכול לקבל את קוד המקור מכל סוג GIT או אפילו מ-S3.
- ה-CodeBuild מקבל את הוראות הבנייה מ-buildspec.yml, שיושב כברירת מחדל בתקיית האב של קוד המקור.
- ה-CodeBuild מיועד לבנות את הקוד, להריץ בדיקות ולדחוף את חבילות התוצר ל-repository.

### CodeDeploy

- ה-CD של AWS
- פורס את התוכנה ל-EC2, Lambda, ECS
- ניתן להריץ hooks (פקודות) בשלבי הפריסה השונים.
- ניתן לבחור אסטרטגית שדרוג, ע"מ להימדע מ-downtime.
- במקרה נפילה - codeDeploy יודע להריץ rollback.
- Revision - הקוד לפריסה, מכיל גם את קובץ ה-AppSpec.
- AppSpec - הוראות ההתקנה וה-hooks.
- ה-CodeDeploy מחולק ל-Application - סביבות נפרדות.
- על application מכיל Deployment Group - קבוצות שרתים המייצגות רכיב אחד.
- Deployment - פריסה בפועל של השירותים

### CodePipeline

- מבצע את כלל ה-pipeline מהקוד ועד לפריסה.
- ה-pipeline נבנה ב-aws (או מוקם באמצעות CloudFrormation וכד')
- ב-pipeline מורכב מ-stageS - שלבים נפרדים של התהליך.
- כל stage מורכב מ-actions, פעולות המבוצעות.
- ה-stages מעבירים קבצים ביניהם באמצעות artifact.
- ניתן להגדיר ממגוון של ספקים חיצוניים עבור source provider, build provider, deploy provider.
- אפשר לדרוש אישור ידני למעבר בין stage-ים.

# Serverless Computing

## ECS - Elastic Container Service

### task

- תא של containers, כמו pod ב-kubernetes.
- מריץ docker images שיוצרו באמצעות dockerfiles.

### task definition

- קובץ ההגדרות של ה-container
- מכיל הגדרות כדוגמת:
  - השרת עליו ה-task רץ (EC2/Faregate, OS, משאבים)
  - role עבור ה-task
  - הגדרות ה-container (image, פורטים)
  - ניתור

### ECS Container instances

- שרתי EC2 שמיועדים להכיל tasks.
- השרתים מסוג Amazon ECS-Optimized AMI
- השרתים מריצים service בשם ECS agent 

### Faregate

- מעטפת חיצונית להרצת tasks
- מייתר לחלוטין את הטיפול בתשתיות השרת

### ECS Service

- מקביל ל-SC עבור tasks
- יודע להבצע scale במידת הצורך
- מתחבר ל-LB.
- פורס על פני AZ שונים.

### ECS cluster

- קבוצה לוגית של task-ים
- יכול להיפרס על פני מספר AZ
- מכיל את כל שאר האובייקטים של ECS

### ECR - Elastic Container Registry

- registry עבור ה-ECS - שומר על ה-docker images.

##  Lambda

- הרצת function כשמתרחש אירוע
- ישנם מגוון אירועים שניתן להגדיר שיטריגו את ה-function.
- ה-function מריץ סקריפט במגוון שפות.
- ה-function מחובר ל-role שמאפשר לו להשפיע על אירועים אחרים.
- בכל פעם שהאירוע מתרחש - מתחיל לרוץ instacne של ה-function, עד להגבלת concurrency.
- ה-lambda ממוקמת ב-region, מה שאומר שכברירת מחדל לא ניתן לגשת ל-VPC
- אם בוצע חיבור של ה-lambda ל-VPC - כשהיא תוקם, יוקם בכל subnet ENI (Elastic Network Interface).
- אם ה-Lambda רוצה לצאת מתוך ה-VPC ל-Internet Gateway - חייב שיהיה NAT Gateway.

## תקשורת בין רכיבים

### SQS - Simple Queue Service

- מעביר הודעה בין שירותים שונים.
- נועד ל-SOC ולאפשר תור הודעות עד שהשירות מתפנה לקבל עוד הודעה.
- מסייע לתהליכים א-סנכרוננים
- ה-SQS שומר את ההודעה עבור צרכן אחד בלבד. ברגע שנקראה ההודעה נמחקת.
- ניתן ליצור לו lambda trigger שיפעיל lambda שתקרא את ההודעה.

### SNS

- הפצת הודעה בין שירותים שונים.
- דוחף את ההודעה לכל הצרכנים שנרשמו.
- לא שומר על ההודעות.
- ניתן לשלב עם מספר SQS על מנת ליצור מספר תורים.

### Amazon MQ

- ניהול תורים עבור אפליקציות שאינם תומכות SQS/SNS.
- תומך בפרוטוקולים סטנדרטיים: AMQP, MQTT, STOMP.
- תואם ל-ActiveMQ ו-RabbitMQ.

### EventBridge

- דחיפת התראות כשמתרחש event מסוים.
- יכול לקרוא event מכמעט כל אובייקט ב-AWS, מ-SaaS חיצונים ומ-custom event.
- שולח מידע מלא על האירוע.
- ניתן ליצור כללים על תוכן האירוע. ההודעה תישלח לאותם שתואמים לכלל.
- מאפשר Event Replay – להריץ מחדש היסטוריה.

### Step Functions

- סדר פעולות לוגי עם תנאים מורכבים.
- נועד עבור תהליך סנכרוני סדור.
- יכול להכיל תנאים ומצבים כמו: delay, Choice states
- מעקב ברור לראייה

## API Gatway

- ניתוב בקשות REST API לשירותים השונים
- מנתב לפי נתיב וסוג בקשה
- סוגי API:
  - HTTP API - נוצן מענה בסיסי לפניות, יודע להטריג Lambda או HTTP Backend.
  - REST API - גרסה משודרגת, כוללת פיצ'רים בסגנון הזדהות, VPC Link.
  - WebSocket API - תקשורת דו כיוונית בזמן אמת (משחקים, צא'טים וכד').
- כוללת stage - הפרדה בין סביבות שונות ב-URL
- resources - מתוך ה-stage מאפשר את הניתוב למקומות השונים בהתאם למוי ולסוג הבקשה.

# נושאים נוספים

### CloudTrail

- ה-event viewer של AWS.
- מבצע ניתור אחרי כל פעולה משמעותית, בסגנון:
  - שינוי במשתמשים.
  - יצירת או שינוי משאבים.
  - הפעלת lambda.
  - קריאות ל-DB ולשירותים נוספים.
- מתעד מי ביצע את הפעולה.


